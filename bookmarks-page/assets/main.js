import{j as e,r as u,u as V,c as R}from"./useBookmarks.js";function F({value:t,onChange:n,placeholder:s}){return e.jsxs("div",{className:"search-bar",children:[e.jsxs("svg",{className:"search-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),e.jsx("input",{type:"text",className:"search-input",value:t,onChange:a=>n(a.target.value),placeholder:s||"Search by title, channel, or keywords..."})]})}function P(){const[t,n]=u.useState(()=>localStorage.getItem("yt-bookmark-theme")||"dark");u.useEffect(()=>{document.documentElement.setAttribute("data-theme",t),localStorage.setItem("yt-bookmark-theme",t)},[t]);const s=()=>{n(a=>a==="dark"?"light":"dark")};return e.jsx("button",{className:"theme-toggle",onClick:s,"aria-label":`Switch to ${t==="dark"?"light":"dark"} mode`,title:`Switch to ${t==="dark"?"light":"dark"} mode`,children:t==="dark"?e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"5"}),e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),e.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),e.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),e.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),e.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),e.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),e.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}):e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})}function H({searchQuery:t,onSearchChange:n,onExport:s,onImport:a}){const o=u.useRef(null),l=()=>{o.current?.click()},r=i=>{const d=i.target.files?.[0];d&&(a(d),i.target.value="")};return e.jsx("header",{className:"header",children:e.jsxs("div",{className:"header-content",children:[e.jsxs("div",{className:"logo",children:[e.jsx("div",{className:"logo-icon",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"})})}),e.jsx("span",{className:"logo-text",children:"Marker"})]}),e.jsxs("div",{className:"header-right",children:[e.jsx(F,{value:t,onChange:n,placeholder:"Search by title, channel, or keywords..."}),e.jsxs("div",{className:"header-actions",children:[e.jsxs("button",{className:"btn btn-primary",onClick:s,children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),"Export"]}),e.jsxs("button",{className:"btn btn-secondary",onClick:l,children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Import CSV"]}),e.jsx("input",{ref:o,type:"file",accept:".csv",onChange:r,style:{display:"none"}}),e.jsx(P,{})]})]})]})})}const q=[{key:"unwatched",label:"Unwatched"},{key:"watched",label:"Watched"}];function Q({activeTab:t,onTabChange:n,counts:s}){return e.jsx("div",{className:"tab-bar",children:e.jsx("div",{className:"tab-bar-inner",children:q.map(a=>e.jsxs("button",{className:`tab-item ${t===a.key?"active":""}`,onClick:()=>n(a.key),children:[e.jsx("span",{className:"tab-label",children:a.label}),e.jsx("span",{className:"tab-count",children:s[a.key]??0})]},a.key))})})}function J({value:t,onChange:n}){return e.jsxs("div",{className:"sort-dropdown",children:[e.jsx("label",{htmlFor:"sort-select",className:"sort-label",children:"Sort by:"}),e.jsxs("select",{id:"sort-select",className:"sort-select",value:t,onChange:s=>n(s.target.value),children:[e.jsx("option",{value:"date-desc",children:"Date Added (Newest)"}),e.jsx("option",{value:"date-asc",children:"Date Added (Oldest)"}),e.jsx("option",{value:"channel",children:"Channel A-Z"}),e.jsx("option",{value:"title",children:"Title A-Z"})]})]})}function Z({sortOption:t,onSortChange:n,selectionMode:s,onToggleSelectionMode:a}){return e.jsx("div",{className:"stats-bar",children:e.jsxs("div",{className:"stats-right",children:[e.jsx("button",{className:`select-btn ${s?"active":""}`,onClick:a,children:s?"Cancel":"Select"}),e.jsx(J,{value:t,onChange:n})]})})}function G(t){const n=new Date(t),a=new Date-n,o=Math.floor(a/1e3),l=Math.floor(o/60),r=Math.floor(l/60),i=Math.floor(r/24),d=Math.floor(i/7);return Math.floor(i/30)>0?n.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):d>0?`${d} week${d>1?"s":""} ago`:i>0?`${i} day${i>1?"s":""} ago`:r>0?`${r} hour${r>1?"s":""} ago`:l>0?`${l} minute${l>1?"s":""} ago`:"Just now"}function K(t){const n=Math.floor(t/3600),s=Math.floor(t%3600/60),a=t%60;return n>0?`${n}:${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${s}:${a.toString().padStart(2,"0")}`}function Y({bookmark:t,onDelete:n,selectionMode:s,isSelected:a,onSelect:o}){const l=`https://i.ytimg.com/vi/${t.video_id}/mqdefault.jpg`,r=`https://www.youtube.com/watch?v=${t.video_id}`,i=t.video_url,d=h=>{h.stopPropagation(),s||window.open(i,"_blank")},x=h=>{h.stopPropagation(),!s&&t.channel_url&&window.open(t.channel_url,"_blank")},y=()=>{s?o?.(t.id):window.open(r,"_blank")},k=h=>{h.stopPropagation(),n?.(t.id)},b=h=>{h.stopPropagation(),o?.(t.id)},p=t.video_duration_seconds||t.timestamp_seconds,f=["bookmark-card",s&&"selection-mode",a&&"selected",t.watched&&"watched"].filter(Boolean).join(" ");return e.jsxs("article",{className:f,onClick:y,children:[s&&e.jsx("div",{className:"card-checkbox",onClick:b,children:e.jsx("div",{className:`checkbox ${a?"checked":""}`,children:a&&e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})})}),e.jsxs("div",{className:"card-thumbnail",children:[e.jsx("img",{src:l,alt:t.video_title,loading:"lazy"}),e.jsx("span",{className:"duration-badge",children:K(p)}),t.watched&&e.jsxs("span",{className:"watched-badge",children:[e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),"Watched"]})]}),e.jsxs("div",{className:"card-channel",children:[e.jsxs("div",{className:`channel-link ${t.channel_url?"clickable":""}`,onClick:x,title:t.channel_url?"Visit channel":"",children:[e.jsx("div",{className:"channel-avatar",children:t.channel_avatar?e.jsx("img",{src:t.channel_avatar,alt:t.channel_name}):e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"})})}),e.jsx("span",{className:"channel-name",children:t.channel_name})]}),e.jsx("span",{className:"card-date",children:G(t.created_at)})]}),e.jsx("h3",{className:"card-title",children:t.video_title}),e.jsxs("div",{className:"card-footer",children:[e.jsxs("button",{className:"timestamp-badge",onClick:d,title:"Jump to timestamp",children:[e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("polyline",{points:"12 6 12 12 16 14"})]}),t.timestamp_hh_mm_ss]}),!s&&e.jsx("button",{className:"delete-btn",onClick:k,title:"Delete bookmark",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),e.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),e.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})]})}function X({bookmarks:t,onDelete:n,selectionMode:s,selectedIds:a,onSelect:o}){return t.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:e.jsx("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}),e.jsx("h3",{className:"empty-title",children:"No bookmarks found"}),e.jsxs("p",{className:"empty-text",children:["Try adjusting your search or add bookmarks on YouTube with ",e.jsx("kbd",{children:"Ctrl+Shift+L"})]})]}):e.jsx("div",{className:"bookmark-grid",children:t.map(l=>e.jsx(Y,{bookmark:l,onDelete:n,selectionMode:s,isSelected:a.has(l.id),onSelect:o},l.id))})}function ee({selectedCount:t,totalCount:n,onSelectAll:s,onDeselectAll:a,onMarkWatched:o,onMarkUnwatched:l,onDelete:r,onCancel:i}){const d=t===n&&n>0;return e.jsxs("div",{className:"bulk-action-bar",children:[e.jsxs("div",{className:"bulk-action-info",children:[e.jsxs("button",{className:`bulk-btn bulk-btn-select-all ${d?"all-selected":""}`,onClick:d?a:s,children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:d?e.jsxs(e.Fragment,{children:[e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3",fill:"currentColor"}),e.jsx("polyline",{points:"7 12 10.5 15.5 17 9",stroke:"white",strokeWidth:"2.5"})]}):e.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"})}),d?"Deselect All":"Select All"]}),e.jsxs("span",{className:"selected-count",children:[t," selected"]})]}),e.jsxs("div",{className:"bulk-action-buttons",children:[e.jsxs("button",{className:"bulk-btn bulk-btn-watched",onClick:o,disabled:t===0,children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"Mark Watched"]}),e.jsxs("button",{className:"bulk-btn bulk-btn-unwatched",onClick:l,disabled:t===0,children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M17.94 17.94C16.28 19.19 14.23 20 12 20c-7 0-11-8-11-8a21.3 21.3 0 0 1 5.06-6.06M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a21.3 21.3 0 0 1-2.16 3.19"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),"Mark Unwatched"]}),e.jsxs("button",{className:"bulk-btn bulk-btn-delete",onClick:r,disabled:t===0,children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),"Delete"]}),e.jsx("button",{className:"bulk-btn bulk-btn-cancel",onClick:i,children:"Cancel"})]})]})}function te({isOpen:t,title:n,message:s,confirmText:a,cancelText:o,onConfirm:l,onCancel:r,variant:i}){return u.useEffect(()=>{const d=x=>{x.key==="Escape"&&t&&r()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[t,r]),t?e.jsx("div",{className:"modal-overlay",onClick:r,children:e.jsxs("div",{className:"modal-content",onClick:d=>d.stopPropagation(),children:[e.jsx("h3",{className:"modal-title",children:n}),e.jsx("p",{className:"modal-message",children:s}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"modal-btn modal-btn-cancel",onClick:r,children:o||"Cancel"}),e.jsx("button",{className:`modal-btn modal-btn-confirm ${i==="danger"?"danger":""}`,onClick:l,children:a||"Confirm"})]})]})}):null}function ne({isOpen:t,title:n,message:s,buttonText:a,onClose:o,variant:l}){return u.useEffect(()=>{const r=i=>{i.key==="Escape"&&t&&o()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[t,o]),t?e.jsx("div",{className:"modal-overlay",onClick:o,children:e.jsxs("div",{className:"modal-content",onClick:r=>r.stopPropagation(),children:[e.jsx("h3",{className:"modal-title",children:n}),e.jsx("p",{className:"modal-message",children:s}),e.jsx("div",{className:"modal-actions modal-actions-single",children:e.jsx("button",{className:`modal-btn modal-btn-confirm ${l==="danger"?"danger":l==="success"?"success":""}`,onClick:o,children:a||"OK"})})]})}):null}function w(t){if(t==null)return"";const n=String(t);return n.includes('"')||n.includes(",")||n.includes(`
`)||n.includes("\r")?'"'+n.replace(/"/g,'""')+'"':n}function se(t){const n=[];let s="",a=!1;for(let o=0;o<t.length;o++){const l=t[o];l==='"'?a=!a:l===","&&!a?(n.push(s),s=""):s+=l}return n.push(s),n}function ae(t){if(t.length===0){alert("No bookmarks to export!");return}const n="video_id,video_title,channel_name,timestamp_seconds,timestamp_hh_mm_ss,video_url,created_at,video_duration_seconds",s=t.map(i=>[w(i.video_id),w(i.video_title),w(i.channel_name),w(i.timestamp_seconds),w(i.timestamp_hh_mm_ss),w(i.video_url),w(i.created_at),w(i.video_duration_seconds||"")].join(",")),a=[n,...s].join(`
`),o=new Blob([a],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(o),r=document.createElement("a");r.href=l,r.download=`youtube-bookmarks-${new Date().toISOString().split("T")[0]}.csv`,r.click(),URL.revokeObjectURL(l)}function le(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=Math.random()*16|0;return(t==="x"?n:n&3|8).toString(16)})}function oe(t){return new Promise((n,s)=>{const a=new FileReader;a.onload=o=>{try{const d=o.target.result.split(`
`).slice(1).filter(x=>x.trim()).map(x=>{const[y,k,b,p,f,h,m,g]=se(x);return{id:le(),video_id:y,video_title:k.replace(/^"|"$/g,"").replace(/""/g,'"'),channel_name:b.replace(/^"|"$/g,"").replace(/""/g,'"'),timestamp_seconds:parseInt(p)||0,timestamp_hh_mm_ss:f,video_url:h,created_at:m,video_duration_seconds:g?parseInt(g):null}});n(d)}catch(l){s(l)}},a.onerror=()=>s(new Error("Failed to read file")),a.readAsText(t)})}function ie(){const{bookmarks:t,filteredBookmarks:n,loading:s,searchQuery:a,setSearchQuery:o,sortOption:l,setSortOption:r,deleteBookmark:i,importBookmarks:d,bulkSetWatched:x,bulkDelete:y}=V(),[k,b]=u.useState("unwatched"),[p,f]=u.useState(!1),[h,m]=u.useState(new Set),[g,N]=u.useState({isOpen:!1,title:"",message:"",confirmText:"",onConfirm:null,variant:"danger"}),[C,S]=u.useState({isOpen:!1,title:"",message:"",variant:"success"});u.useEffect(()=>{const c=localStorage.getItem("yt-bookmark-theme")||"dark";document.documentElement.setAttribute("data-theme",c)},[]);const B=u.useMemo(()=>{const c=n.filter(j=>j.watched).length,v=n.filter(j=>!j.watched).length;return{all:n.length,watched:c,unwatched:v}},[n]),_=u.useMemo(()=>k==="watched"?n.filter(c=>c.watched):k==="unwatched"?n.filter(c=>!c.watched):n,[n,k]),M=()=>{N(c=>({...c,isOpen:!1}))},L=()=>{p&&m(new Set),f(!p)},$=c=>{m(v=>{const j=new Set(v);return j.has(c)?j.delete(c):j.add(c),j})},T=()=>{const c=new Set(_.map(v=>v.id));m(c)},D=()=>{m(new Set)},A=async()=>{await x(Array.from(h),!0),m(new Set),f(!1)},E=async()=>{await x(Array.from(h),!1),m(new Set),f(!1)},W=()=>{const c=h.size;N({isOpen:!0,title:"Delete Bookmarks",message:`Are you sure you want to delete ${c} bookmark${c>1?"s":""}? This action cannot be undone.`,confirmText:"Delete",variant:"danger",onConfirm:async()=>{await y(Array.from(h)),m(new Set),f(!1),M()}})},I=c=>{N({isOpen:!0,title:"Delete Bookmark",message:"Are you sure you want to delete this bookmark? This action cannot be undone.",confirmText:"Delete",variant:"danger",onConfirm:async()=>{await i(c),M()}})},O=()=>{m(new Set),f(!1)},U=()=>{ae(t)},z=async c=>{try{const v=await oe(c),j=await d(v);S({isOpen:!0,title:"Import Successful",message:j.message,variant:"success"})}catch(v){S({isOpen:!0,title:"Import Failed",message:"Error importing CSV: "+v.message,variant:"danger"})}};return s?e.jsx("div",{className:"app",children:e.jsxs("div",{className:"loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading bookmarks..."})]})}):e.jsxs("div",{className:"app",children:[e.jsx(H,{searchQuery:a,onSearchChange:o,onExport:U,onImport:z}),e.jsxs("main",{className:"main-content",children:[e.jsx(Q,{activeTab:k,onTabChange:b,counts:B}),e.jsx(Z,{sortOption:l,onSortChange:r,selectionMode:p,onToggleSelectionMode:L}),e.jsx(X,{bookmarks:_,onDelete:I,selectionMode:p,selectedIds:h,onSelect:$})]}),p&&e.jsx(ee,{selectedCount:h.size,totalCount:_.length,onSelectAll:T,onDeselectAll:D,onMarkWatched:A,onMarkUnwatched:E,onDelete:W,onCancel:O}),e.jsx(te,{isOpen:g.isOpen,title:g.title,message:g.message,confirmText:g.confirmText,variant:g.variant,onConfirm:g.onConfirm,onCancel:M}),e.jsx(ne,{isOpen:C.isOpen,title:C.title,message:C.message,variant:C.variant,onClose:()=>S(c=>({...c,isOpen:!1}))})]})}R.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(ie,{})}));
